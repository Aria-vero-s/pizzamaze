{% extends 'base.html' %}
{% load static %}
{% block body %}

<img src="{% static "spag1.avif" %}" style="width:100%;">

<script type="text/javascript">
    $(document).ready(function() {
    
        $("#create-book").modalForm({
            formURL: "{% url 'create_book' %}"
        });
    
    });
    </script>

<div class="modal fade" tabindex="-1" role="dialog" id="modal">
    <div class="modal-dialog" role="document">
      <div class="modal-content"></div>
    </div>
  </div>
  
  <!-- Create book button -->
  <button id="create-book" class="btn btn-primary" type="button" name="button">Create book</button>
  
  <script type="text/javascript">
    $(document).ready(function() {
    
        $("#create-book").modalForm({
            formURL: "{% url 'create_book' %}"
        });
    
    });
    </script>

<!-- asyncSettings.dataElementId -->
<table id="books-table" class="table">
    <thead>
      ...
    </thead>
    <tbody>
    {% for book in books %}
      <tr>
          ...
          <!-- Update book buttons -->
          <button type="button" class="update-book btn btn-sm btn-primary" data-form-url="{% url 'update_book' book.pk %}">
            <span class="fa fa-pencil"></span>
          </button>
          ...
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
  
  <script type="text/javascript">
      $(function () {
          ...
  
          # asyncSettings.successMessage
          var asyncSuccessMessage = [
            "<div ",
            "style='position:fixed;top:0;z-index:10000;width:100%;border-radius:0;' ",
            "class='alert alert-icon alert-success alert-dismissible fade show mb-0' role='alert'>",
            "Success: Book was updated.",
            "<button type='button' class='close' data-dismiss='alert' aria-label='Close'>",
            "<span aria-hidden='true'>&times;</span>",
            "</button>",
            "</div>",
            "<script>",
            "$('.alert').fadeTo(2000, 500).slideUp(500, function () {$('.alert').slideUp(500).remove();});",
            "<\/script>"
          ].join();
  
          # asyncSettings.addModalFormFunction
          function updateBookModalForm() {
            $(".update-book").each(function () {
              $(this).modalForm({
                formURL: $(this).data("form-url"),
                asyncUpdate: true,
                asyncSettings: {
                  closeOnSubmit: false,
                  successMessage: asyncSuccessMessage
                  dataUrl: "books/",
                  dataElementId: "#books-table",
                  dataKey: "table",
                  addModalFormFunction: updateBookModalForm
                }
              });
            });
          }
          updateBookModalForm();
  
          ...
      });
  </script>

{% endblock %}